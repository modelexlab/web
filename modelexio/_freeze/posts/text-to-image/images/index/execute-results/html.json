{
  "hash": "e4cab3c609df8f5cd907316f80485d33",
  "result": {
    "markdown": "---\ntitle: \"Text-to-image\"\nauthor: \"Modelex\"\ndate: \"2023-10-12\"\ncategories: [NLP, text, image, generation, deep learning]\n---\n\n# **SD-XL 1.0-base Model Card**\n\n**Model type:** Diffusion-based text-to-image generative model\n\n![](MODELEX-2.png){fig-align=\"center\"}\n\n**Make sure to upgrade diffusers to \\>= 0.19.0:**\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\n!pip install diffusers --upgrade\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRequirement already satisfied: diffusers in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (0.21.4)\r\nRequirement already satisfied: Pillow in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from diffusers) (9.4.0)\r\nRequirement already satisfied: filelock in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from diffusers) (3.9.0)\r\nRequirement already satisfied: huggingface-hub>=0.13.2 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from diffusers) (0.15.1)\r\nRequirement already satisfied: importlib-metadata in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from diffusers) (6.0.0)\r\nRequirement already satisfied: numpy in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from diffusers) (1.23.5)\r\nRequirement already satisfied: regex!=2019.12.17 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from diffusers) (2022.7.9)\r\nRequirement already satisfied: requests in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from diffusers) (2.31.0)\r\nRequirement already satisfied: safetensors>=0.3.1 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from diffusers) (0.3.2)\r\nRequirement already satisfied: fsspec in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from huggingface-hub>=0.13.2->diffusers) (2023.4.0)\r\nRequirement already satisfied: tqdm>=4.42.1 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from huggingface-hub>=0.13.2->diffusers) (4.65.0)\r\nRequirement already satisfied: pyyaml>=5.1 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from huggingface-hub>=0.13.2->diffusers) (6.0)\r\nRequirement already satisfied: typing-extensions>=3.7.4.3 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from huggingface-hub>=0.13.2->diffusers) (4.7.1)\r\nRequirement already satisfied: packaging>=20.9 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from huggingface-hub>=0.13.2->diffusers) (23.1)\r\nRequirement already satisfied: zipp>=0.5 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from importlib-metadata->diffusers) (3.11.0)\r\nRequirement already satisfied: charset-normalizer<4,>=2 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from requests->diffusers) (2.0.4)\r\nRequirement already satisfied: idna<4,>=2.5 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from requests->diffusers) (3.4)\r\nRequirement already satisfied: urllib3<3,>=1.21.1 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from requests->diffusers) (1.26.16)\r\nRequirement already satisfied: certifi>=2017.4.17 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from requests->diffusers) (2023.7.22)\r\n```\n:::\n:::\n\n\n**In addition make sure to install `transformers`, `safetensors`, `accelerate` as well as the invisible watermark:**\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\n!pip install invisible_watermark transformers accelerate safetensors\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRequirement already satisfied: invisible_watermark in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (0.2.0)\r\nRequirement already satisfied: transformers in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (4.32.1)\r\nRequirement already satisfied: accelerate in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (0.23.0)\r\nRequirement already satisfied: safetensors in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (0.3.2)\r\nRequirement already satisfied: Pillow>=6.0.0 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from invisible_watermark) (9.4.0)\r\nRequirement already satisfied: PyWavelets>=1.1.1 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from invisible_watermark) (1.4.1)\r\nRequirement already satisfied: numpy>=1.17.0 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from invisible_watermark) (1.23.5)\r\nRequirement already satisfied: opencv-python>=4.1.0.25 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from invisible_watermark) (4.8.1.78)\r\nRequirement already satisfied: torch in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from invisible_watermark) (2.1.0)\r\nRequirement already satisfied: filelock in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from transformers) (3.9.0)\r\nRequirement already satisfied: huggingface-hub<1.0,>=0.15.1 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from transformers) (0.15.1)\r\nRequirement already satisfied: packaging>=20.0 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from transformers) (23.1)\r\nRequirement already satisfied: pyyaml>=5.1 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from transformers) (6.0)\r\nRequirement already satisfied: regex!=2019.12.17 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from transformers) (2022.7.9)\r\nRequirement already satisfied: requests in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from transformers) (2.31.0)\r\nRequirement already satisfied: tokenizers!=0.11.3,<0.14,>=0.11.1 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from transformers) (0.13.2)\r\nRequirement already satisfied: tqdm>=4.27 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from transformers) (4.65.0)\r\nRequirement already satisfied: psutil in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from accelerate) (5.9.0)\r\nRequirement already satisfied: fsspec in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.15.1->transformers) (2023.4.0)\r\nRequirement already satisfied: typing-extensions>=3.7.4.3 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.15.1->transformers) (4.7.1)\r\nRequirement already satisfied: sympy in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from torch->invisible_watermark) (1.11.1)\r\nRequirement already satisfied: networkx in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from torch->invisible_watermark) (3.1)\r\nRequirement already satisfied: jinja2 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from torch->invisible_watermark) (3.1.2)\r\nRequirement already satisfied: charset-normalizer<4,>=2 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from requests->transformers) (2.0.4)\r\nRequirement already satisfied: idna<4,>=2.5 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from requests->transformers) (3.4)\r\nRequirement already satisfied: urllib3<3,>=1.21.1 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from requests->transformers) (1.26.16)\r\nRequirement already satisfied: certifi>=2017.4.17 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from requests->transformers) (2023.7.22)\r\nRequirement already satisfied: MarkupSafe>=2.0 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from jinja2->torch->invisible_watermark) (2.1.1)\r\nRequirement already satisfied: mpmath>=0.19 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from sympy->torch->invisible_watermark) (1.3.0)\r\n```\n:::\n:::\n\n\n**Install torch:**\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\n!pip install torch\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRequirement already satisfied: torch in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (2.1.0)\r\nRequirement already satisfied: filelock in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from torch) (3.9.0)\r\nRequirement already satisfied: typing-extensions in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from torch) (4.7.1)\r\nRequirement already satisfied: sympy in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from torch) (1.11.1)\r\nRequirement already satisfied: networkx in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from torch) (3.1)\r\nRequirement already satisfied: jinja2 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from torch) (3.1.2)\r\nRequirement already satisfied: fsspec in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from torch) (2023.4.0)\r\nRequirement already satisfied: MarkupSafe>=2.0 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from jinja2->torch) (2.1.1)\r\nRequirement already satisfied: mpmath>=0.19 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from sympy->torch) (1.3.0)\r\n```\n:::\n:::\n\n\n**Install io:**\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\n!pip install requires.io\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRequirement already satisfied: requires.io in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (0.2.6)\r\nRequirement already satisfied: requests>=2.0.0 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from requires.io) (2.31.0)\r\nRequirement already satisfied: charset-normalizer<4,>=2 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from requests>=2.0.0->requires.io) (2.0.4)\r\nRequirement already satisfied: idna<4,>=2.5 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from requests>=2.0.0->requires.io) (3.4)\r\nRequirement already satisfied: urllib3<3,>=1.21.1 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from requests>=2.0.0->requires.io) (1.26.16)\r\nRequirement already satisfied: certifi>=2017.4.17 in /Users/simon-pierreboucher/anaconda3/lib/python3.11/site-packages (from requests>=2.0.0->requires.io) (2023.7.22)\r\n```\n:::\n:::\n\n\n**Inference API request:**\n\n**token**: *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*\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\nimport requests\nAPI_URL = \"https://api-inference.huggingface.co/models/stabilityai/stable-diffusion-xl-base-1.0\"\nheaders = {\"Authorization\": \"Bearer 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\"}\n```\n:::\n\n\nGenerate image with prompt:\n\n```         \nAstronaut riding a horse\n```\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\ndef query(payload):\n\tresponse = requests.post(API_URL, headers=headers, json=payload)\n\treturn response.content\nimage_bytes = query({\n\t\"inputs\": \"Astronaut riding a horse\",\n})\n# You can access the image with PIL.Image for example\nimport io\nfrom PIL import Image\nimage = Image.open(io.BytesIO(image_bytes))\nimage\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n![](index_files/figure-html/cell-7-output-1.png){}\n:::\n:::\n\n\n```         \nGarfield on the moon\n```\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\ndef query(payload):\n\tresponse = requests.post(API_URL, headers=headers, json=payload)\n\treturn response.content\nimage_bytes = query({\n\t\"inputs\": \"Garfield on the moon\",\n})\n# You can access the image with PIL.Image for example\nimport io\nfrom PIL import Image\nimage = Image.open(io.BytesIO(image_bytes))\nimage\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n![](index_files/figure-html/cell-8-output-1.png){}\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}